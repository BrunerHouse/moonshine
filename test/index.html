<html>
	<head>
		<title></title>

		<link rel="stylesheet" href="../debug/css/debug.luajs.css" />
				
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
		<script src="/frameworks/jquery/jquery.min.js"></script>
		
		<!-- script src="../vm/luajs.js"></script -->

		<script src="../vm/src/EventEmitter.js"></script>
		<script src="../vm/src/VM.js"></script>
		<script src="../vm/src/Closure.js"></script>
		<script src="../vm/src/Function.js"></script>
		<script src="../vm/src/Coroutine.js"></script>
		<script src="../vm/src/Table.js"></script>
		<script src="../vm/src/Error.js"></script>
		<script src="../vm/src/File.js"></script>
		<script src="../vm/src/lib.js"></script>
		<script src="../vm/src/utils.js"></script>
		<script src="../vm/src/output.js"></script>
		
		<!-- script src="../debug/debug.luajs.js"></script -->


		<script>
		
			var debugText = '';
			window.setInterval (function () { $('#debug').text (debugText); }, 500);

			luajs.stdout.write = function (message) {
				$('#output').append (message + '\n');
				//if (console && console.log) console.log (message);
			};
			

			luajs.stddebug.write = function (message) {
				debugText += message + '\n';
			};
			

			$(function () {
				vm = new luajs.VM ();
				
				var loaded = 0;
				vm.bind ('loaded-file', function () {
					if (++loaded == 2) vm.execute ();
				});
				
				vm.load ('./scripts/test-suite.json', false);
				vm.load ('./scripts/coroutine.json', false);
			
				$(document).keypress (function () {
					$('#debug').empty ();
				});
			});
			
		</script>
		
		<style>
			#debug,
			#output {
				width: 1000px;
				height: 300px;
				overflow-y: auto;
				background-color: black;
				color: white;
				font-family: 'Monaco';
				font-size: 10px;
				margin: 20px auto;
				padding: 4px;
				color: #ddd;
			}

			p {
				margin: 0;
				padding: 0;
			}			

			p.error {
				color: red;
			}
			
		</style>
	</head>
	
	<body>
		<pre id="output"></pre>
		<pre id="debug"></pre>
	</body>
</html>
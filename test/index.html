<html>
	<head>
		<title></title>

		<link rel="stylesheet" href="../debug/css/debug.luajs.css" />
				
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
		<script src="/frameworks/jquery/jquery.min.js"></script>
		
		<script src="../vm/src/EventEmitter.js"></script>
		<script src="../vm/src/VM.js"></script>
		<script src="../vm/src/Closure.js"></script>
		<script src="../vm/src/Function.js"></script>
		<script src="../vm/src/Coroutine.js"></script>
		<script src="../vm/src/Table.js"></script>
		<script src="../vm/src/Error.js"></script>
		<script src="../vm/src/File.js"></script>
		<script src="../vm/src/lib.js"></script>
		<script src="../vm/src/utils.js"></script>
		<script src="../vm/src/output.js"></script>
		
		<!-- script src="../debug/debug.luajs.js"></script -->
		<script src="http://paulcuth.me.uk/lichen/lichen.js.php?accept=$,jQuery,luajs"></script>

		<style>
			#debug,
			#output {
				width: 1000px;
				height: 300px;
				overflow-y: auto;
				background-color: black;
				color: white;
				font-family: 'Monaco';
				font-size: 10px;
				margin: 20px auto;
				padding: 4px;
				color: #ddd;
			}

			p {
				margin: 0;
				padding: 0;
			}			

			p.error {
				color: red;
			}
			
		</style>
	</head>
	
	<body>
		<pre id="output"></pre>
		<!-- pre id="debug"></pre -->

		<script>
			(function () {
				
				var debugText = '',
					elOutput = document.getElementById ('output');
					// elDebug = document.getElementById ('debug');
				
				function escapeHTML(text) {
				    return text.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
				}	

				luajs.stdout.write = function (message) {
					elOutput.innerHTML += escapeHTML (message) + '\n';
				};
					
				function getTimestamp () {
					return Date.now();
				}

				// luajs.stddebug.write = function (message) {
				// 	debugText += escapeHTML (message) + '\n';
				// };
				

				// window.setInterval (function () { 
				// 	elDebug.innerHTML = debugText;
				// }, 500);

	
				var vm = new luajs.VM ({ getTimestamp: getTimestamp });
				
				vm.load ('./scripts/test-suite.lua.json', true);
				//vm.load ('./scripts/coroutine.json', true);
			
			})();
		</script>
	</body>
</html>
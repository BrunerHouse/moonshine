<html>
	<head>
		<title></title>
				
		<script src="../vm/src/gc.js"></script>
		<script src="../vm/src/EventEmitter.js"></script>
		<script src="../vm/src/FileManager.js"></script>
		<script src="../vm/src/VM.js"></script>
		<script src="../vm/src/Register.js"></script>
		<script src="../vm/src/Closure.js"></script>
		<script src="../vm/src/Function.js"></script>
		<script src="../vm/src/Coroutine.js"></script>
		<script src="../vm/src/Table.js"></script>
		<script src="../vm/src/Error.js"></script>
		<script src="../vm/src/File.js"></script>
		<script src="../vm/src/lib.js"></script>
		<script src="../vm/src/utils.js"></script>
		<script src="../vm/src/output.js"></script>
		
		<script src="../debug/debug.moonshine.js"></script>		
		<script src="../debug/local.debug.moonshine.js"></script>
		<script src="http://paulcuth.me.uk/lichen/lichen.js.php?accept=shine,io&amp;position=top-left"></script>

		<style>
			#debug,
			#output {
				width: 1000px;
				height: 300px;
				overflow-y: auto;
				background-color: black;
				color: white;
				font-family: 'Monaco';
				font-size: 10px;
				margin: 20px auto;
				padding: 4px;
				color: #ddd;
			}

			p {
				margin: 0;
				padding: 0;
			}			

			p.error {
				color: red;
			}
			
		</style>
	</head>
	
	<body>
		<pre id="output"></pre>
		<!-- pre id="debug"></pre -->

		<script>
			(function () {
				
				var debugText = '',
					elOutput = document.getElementById ('output');
					// elDebug = document.getElementById ('debug');
				
				function escapeHTML(text) {
				    return text.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
				}	

				shine.stdout.write = function (message) {
					elOutput.innerHTML += escapeHTML (message) + '\n';
				};


				function getTimestamp () {
					return Date.now();
				}
					
				// shine.stddebug.write = function (message) {
				// 	debugText += escapeHTML (message) + '\n';
				// };
				

				// window.setInterval (function () { 
				// 	elDebug.innerHTML = debugText;
				// }, 500);

	
				var vm = new shine.VM ({ getTimestamp: getTimestamp });
				vm.load ('./test-package.json', true);

			})();
		</script>
	</body>
</html>